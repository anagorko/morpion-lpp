% !TEX root = morpion5d.tex

\section{Geometry of Morpion Solitaire positions}
\label{sec:geometry}

%\todo{An introductory sentence}
In this section we collect a number of observations regarding geometric properties of Morpion Solitaire positions and formulate the basic definitions as well as the main result of this paper. 
In order to make linear computations feasible, we will limit the size of boards to rectangular ``boxes''.  In Section \ref{sec:gemmating} we explain why this is enough to solve the general problem of bounding the sequences in Morpion 5D. 
\begin{definition}
A box is a rectangular subset of ${\mathbb Z}^2$ bounded by $4$ edges parallel to the coordinate axes. A bounding box of a Morpion 5D position is the smallest box
containing this position. %rectangular part of the grid that contains this position
%edges parallel to the coordinate axes). 
\todo{Add a precise figure with a bounding box and dimensions, e.g. Figure~\ref{fig:small}}
\end{definition}

Every Morpion 5D graph contains the initial cross, hence the smallest bounding box has dimensions $9 \times 9$.
The graph depicted in Figure~\ref{fig:85} has a bounding box with dimensions $14 \times 13$.
However, the dimensions of the bounding box do not give information about the position of the initial cross inside. Since
this information is important for computations, we introduce the following %, which is important.
%We will employ the following convention.

\begin{notation*}
The distance of a bounding box to the initial cross can be described by $4$ numbers: the distances of the sides of the box to the edges of the cross. 
% is distances of its edges from the edges of the cross.
For graph depicted in Figure~\ref{fig:85} the distance from top edge of the cross to the top side of the bounding box is equal to $3$. For the right side it is $4$, for the bottom side it is $1$ and for the left side it is also $1$. 
The bounding box of the position in Figure~\ref{fig:85} is described as $(3,4,1,1)$.
\end{notation*}
  
\begin{table}[ht]
\centering
\input{table.tex} 

\caption{Bounding boxes mentioned in Theorem \ref{thm:boxes}.\ref{thm:boxes:list} that admit Morpion 5D graphs of sizes $85$, $84$ and $83$. }
\label{tbl:boundingboxes}
\end{table}

Below we formulate the key theorem in this paper: %  \todo{Theorem, proved in Section 4, why is it important}
\begin{theorem}
\begin{enumerate}
\item Up to symmetry every Morpion 5D {\em position} is contained in one of the following boxes:
$(4, 3, 3, 3)$, $(4, 4, 3, 2)$, $(5, 3, 2, 3)$, $(4, 3, 4, 2)$, $(5, 3, 3, 2)$, $(5, 4, 2, 1)$, 
$(6, 2, 2, 1)$, $(5, 4, 0, 2)$, $(5, 1, 4, 0)$. \label{thm:boxes:list}
\item Every box contained in one of the nine boxes listed in 1, with the exception of boxes $(6, 2, 2, 0)$ 
  and $(6, 0, 2, 0)$, is a bounding box of a Morpion 5D {\em graph}.
\item For each box $\mathcal{B}$ described in 2, the size of a maximal Morpion 5D graph with the bounding box $\mathcal{B}$ does not exceed $85$.
  Bounding boxes that admit Morpion 5D graphs of sizes greater than $82$ are listed 
    in Table~\ref{tbl:boundingboxes}. 
% All other boxes described in 2 are bounding boxes of graphs with size at most $82$.
\end{enumerate} 
\label{thm:boxes}
\end{theorem}
We will present a proof of this theorem in the next three sections with a summary of the argument in Subsection \ref{subsec:84}. 
In Section \ref{sec:linear} we precisely define the notion of a Morpion 5D graph. Intuitively, Morpion 5D graphs are obtained from Morpion 5D positions by forgetting about the order in which the moves were played.


%We will consider a class of graphs that are obtained from Morpion 5D positions by forgetting about 
%  the order in which the moves were played. %\todo{Definition of an unordered Morpion 5D graph}


%We will prove using linear programming that that the maximum size of  an unordered Morpion 5D graph with a bounding box equal to one of the bounding boxes listed in Table~\ref{tbl:boundingboxes}
% is $85$. \todo{This looks like a comment which should immediatelly after formulation of the theorem: it says, that we are not dealing
% with all morpion 5d graphs, but only with graphs generated by Morpion 5D positions - it is enough for the corollary that 85 is an upper bound -
% later there will be one more corollary improving on this bound to 84}

\begin{corollary}
\label{cor:84}
The longest sequence of moves in Morpion 5D does not exceed $84$.
\end{corollary}
\begin{proof} 
In Table \ref{tbl:boundingboxes} there are four bounding boxes with maximal graphs of size $85$. 
For these we formulate mixed integer problems with additional constraints that force the graph to
  be a Morpion 5D position.
These problems are much harder to solve, but with correct choice of solver optimization parameters we are able to show
  that there are no solutions of these problems of size $85$. Equipped with additional definitions and lemmas formulated later in this paper, in Subsection \ref{subsec:84} we add some technical 
information to this proof. 
\end{proof}
