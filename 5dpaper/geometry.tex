\section{Geometry of Morpion Solitaire positions}


Consider a Morpion 5D position shown on the left in Figure~\ref{fig:small}. 
The diagram shows a position of a Morpion 5D playout.
We observe that such a diagram allows us to decode the move sequence,
  even though in the example given there are three diffrent lines passing through dot with number $1$
  and it might be not clear which line corresponds to the first move.
However, the last move (in the given ordering) is unique. 
The rest of the moves can be decoded recursively, descending from the last moves in the sequence.
Observe that some of the moves in the sequence may be interchangeable.
However, the set of the played moves is unique with respect to the positions of the moves.

\begin{figure}
    \includegraphics[width=0.49\textwidth]{figures/small1.pdf}
    \includegraphics[width=0.49\textwidth]{figures/small2.pdf}
    \caption{\label{fig:small}
      A Morpion 5D position (left) and a corresponding unordered Morpion 5D graph (right)
    }
\end{figure}

A bounding box of a Morpion 5D position is the smallest rectangular part of the grid that contains it 
  (with edges parallel to the coordinate axes).
Every Morpion 5D graph contains the starting cross and the smallest bounding box has dimensions $9 \times 9$.
The graph depicted in Figure~\ref{fig:85} has a bounding box with dimensions $14 \times 13$.
However, the dimensions of the bounding box do not give information about the position of the starting cross inside, which is important.
We will employ the following convention.
We will describe a bounding box by distances of its edges from the edges of the cross.
For graph depicted in Figure~\ref{fig:85} the distance from top edge of the cross to the top side of the bounding box is equal to $3$. For right side it is $4$, bottom $1$ and left $1$. 
We write that graph from Figure~\ref{fig:85} has a bounding box $(3,4,1,1)$.
  
There is an $8$-element group of isometries of the $\mathbb{Z}^2$ grid that leave the starting cross in place.
Up to these symmetries every Morpion 5D position is contained in a bounding box $(a,b,c,d)$ such that
  $a \leq b,c,d$ and $b \leq d$.

In the sequel we show that every Morpion 5D graph that corresponds to a Morpion 5D position
    must be contained (up to symmetry) in one of the bounding boxes listed in table~\ref{tbl:boundingboxes}.

\begin{table}[ht]
\centering
\input{table.tex} 

\caption{}
\label{tbl:boundingboxes}
\end{table}

We will consider a class of graphs that are obtained from Morpion 5T positions by forgetting about 
  the order in which the moves were played.
(...) See Figure~\ref{fig:small} (right) to see a diagram of an unordered 5D graph. (... also define the size of such a graph ... )
We will call every such graph an \emph{unordered Morpion 5T graph}. See section~\ref{sec:linear} for a formal definition.

\begin{figure}[h]
    \includegraphics[width=0.531\textwidth]{figures/85.pdf}
    \includegraphics[width=0.4645\textwidth]{figures/94.pdf}
    \caption{\label{fig:85}
      An unordered Morpion 5D graph of size $85$ on the left side
        and unmarked unordered Morpion 5D graph of size $94$ on the right side
    }
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.687\textwidth]{figures/uncon.pdf}
  \caption{
    Unmarked unordered Morpion 5D graph may have arbitrarily large bounding box.
  }
\end{figure}

There are Morpion 5D graphs that do not correspond to Morpion 5D positions.
Figure~\ref{fig:85} shows such an example.
We will prove using linear programming that that the maximum size of  an unordered Morpion 5D graph with 
  a bounding box equal to one of the bounding boxes listed in Table~\ref{tbl:boundingboxes}
  is $85$.
There are four bounding boxes with maximal graphs of size $85$. 
For these we formulate mixed integer problems with additional constraints that force the graph to
  be a Morpion 5D position.
These problems are much harder to solve, but with correct choice of solver optimization parameters we are able to show
  that there are no solutions of these problems of size $85$.
This gives us an upper bound of $84$.

In~\cite{} we computed a bound for a different class of graphs that contains all Morpion 5T positions.
These are graphs that can be covered by four-segment lines that are segment-disjoint and such that $4\cdot \# V - \# E = 144$.
We call such graphs \emph{unmarked unordered Morpion graphs} (see section~\ref{sec:linear} for a formal definition).
Considering this class for Morpion 5D  does not give useful bounds. 
Figure~\ref{fig:} shows an example of an unmarked unordered Morpion 5D graph of size $94$.
Moreover, these graphs need not to be connected and therefore the bounding box of such a graph
  can be arbitrarily large.
